## モノイドの応用

モノイドが、「足し合わせたり、組み合わせたり」することを抽象化した何かだ、ということは分かった。さて、どこで使えばいいのだろうか?
モノイドが重要な役割を果たすいくつかの偉大なアイディアがある。
これらについては、本書の後半の事例集でより詳しく見ていく。

### ビッグデータ

Spark や Hadoop のようなビッグデータ解析においては、たくさんのマシンにデータ解析を分散し、耐障害性やスケーラビリティを高めている。
それぞれのマシンがデータの一部を解析した結果を返すので、それを組み合わせて最終的な結果を得ることになる。
ほとんどの場合、これをモノイドとみなすことができる。

Web サイトの訪問者数の合計を計算する場合では、データの各部分にから`Int`値を計算することになる。
足し算という演算が`Int`のモノイドインスタンスを成すことは知っている。そして、足し算こそが部分的な結果を組み合わせるための正しい方法なのだ。

Web サイトのユニーク訪問者数を知るということは、これはデータの各部分にから`Set[User]`を構成するのと同じことである。
`Set`が和集合演算に関してモノイドインスタンスを成すことは知っている。そして、和集合演算こそが部分的な結果を組み合わせるための正しい方法なのだ。

99% または 95% 応答時間をサーバのログから計算したければ、モノイドであるような`QTree`と呼ばれるデータ構造を利用できる。

この考え方が理解できたのならば幸いである。ほとんどの場合、解析対象となる巨大なデータセットはモノイドなので、この考え方に基づいて表現豊かで強力な解析システムを構築できる。
これはまさに Twitter の Algebird や Summingbird のようなプロジェクトがやっていることだ。
[map-reduce](#map-reduce)の事例でこの考え方をもっと詳しく見ていく。

### 分散システム

分散システムにおいて、別々のマシンが1つのデータに対し別々の見方をするという結果に至ることがある。
例えば、あるマシンが他のマシンがまだ受け取っていない最新情報を受け取ることがある。
それ以上更新がなければ、すべてのマシンが同じデータを持っていてほしいので、これらの異なった見方を調停(reconcile)する必要がある。
これを **結果整合性(eventual consistency)** と呼ぶ。

特殊な部類のデータ型はこの調停をサポートする。
このデータ型をは、可換な複製可能データ型(commutative replicated data type, CRDT)と呼ばれている。
鍵となるのは、2つのデータインスタンスを両方が持つ情報をすべて捕捉しながら併合する能力をもつ操作である。
この操作は、データ型がモノイドインスタンスを持つことを要求する。
この考え方については、CRDTの事例でより詳しく見ていく。

### 小さなコードにおけるモノイド

ここで挙げた2つの事例は、モノイドがシステム構成全体を特徴づけるようなものである。
一方、モノイドを利用することで、短いコード片をより楽に書けるようになるケースも多い。
このような例をこの本の中で何度も見ることになるだろう。
